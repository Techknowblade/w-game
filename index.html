<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Pixel Adventure Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #8e44ad;
        }

        canvas {
            border: 2px solid black;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <script>
        // Set up the canvas and context
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // Player properties
        const player = {
            x: 50,
            y: 50,
            width: 32,
            height: 32,
            speed: 4,
            dx: 0,
            dy: 0,
            sprite: new Image(),
            currentFrame: 0,
            totalFrames: 4,  // Number of frames per animation (modify as needed)
            spriteWidth: 32, // Width of a single sprite frame
            spriteHeight: 32, // Height of a single sprite frame
            direction: "down" // Default direction
        };

        // Set up the sprite sheet (Replace this URL with your actual sprite sheet)
        player.sprite.src = 'https://upload.wikimedia.org/wikipedia/commons/6/63/Emoji_1f600.svg'; // Example placeholder sprite

        // Controls for movement
        const keys = {
            up: false,
            down: false,
            left: false,
            right: false
        };

        // Obstacles (simple red blocks)
        const obstacles = [
            { x: 200, y: 100, width: 100, height: 100 },
            { x: 400, y: 300, width: 150, height: 150 }
        ];

        // Game world setup
        const world = {
            width: 800,
            height: 600,
            bgColor: "#f0f0f0"
        };

        // Event listeners for keypresses
        window.addEventListener("keydown", (e) => {
            if (e.key === "ArrowUp") keys.up = true;
            if (e.key === "ArrowDown") keys.down = true;
            if (e.key === "ArrowLeft") keys.left = true;
            if (e.key === "ArrowRight") keys.right = true;
        });

        window.addEventListener("keyup", (e) => {
            if (e.key === "ArrowUp") keys.up = false;
            if (e.key === "ArrowDown") keys.down = false;
            if (e.key === "ArrowLeft") keys.left = false;
            if (e.key === "ArrowRight") keys.right = false;
        });

        // Function to draw the player sprite
        function drawPlayer() {
            const frameX = player.currentFrame * player.spriteWidth;
            const frameY = getSpriteRow(); // Get the Y position of the current direction in the sprite sheet

            ctx.drawImage(
                player.sprite,
                frameX,
                frameY,
                player.spriteWidth,
                player.spriteHeight,
                player.x,
                player.y,
                player.width,
                player.height
            );
        }

        // Get the sprite row based on player direction
        function getSpriteRow() {
            if (keys.up) return 0 * player.spriteHeight; // Row for "up"
            if (keys.down) return 1 * player.spriteHeight; // Row for "down"
            if (keys.left) return 2 * player.spriteHeight; // Row for "left"
            if (keys.right) return 3 * player.spriteHeight; // Row for "right"
            return 0; // Default to down if no keys are pressed
        }

        // Update player position based on keys
        function updatePlayerPosition() {
            if (keys.up) player.dy = -player.speed;
            if (keys.down) player.dy = player.speed;
            if (keys.left) player.dx = -player.speed;
            if (keys.right) player.dx = player.speed;

            // Collision detection with obstacles
            for (let i = 0; i < obstacles.length; i++) {
                if (
                    player.x < obstacles[i].x + obstacles[i].width &&
                    player.x + player.width > obstacles[i].x &&
                    player.y < obstacles[i].y + obstacles[i].height &&
                    player.y + player.height > obstacles[i].y
                ) {
                    // Prevent movement if collision occurs
                    if (player.dx > 0) player.x = obstacles[i].x - player.width; // Right collision
                    if (player.dx < 0) player.x = obstacles[i].x + obstacles[i].width; // Left collision
                    if (player.dy > 0) player.y = obstacles[i].y - player.height; // Down collision
                    if (player.dy < 0) player.y = obstacles[i].y + obstacles[i].height; // Up collision
                }
            }

            player.x += player.dx;
            player.y += player.dy;
            player.dx = 0;
            player.dy = 0;
        }

        // Function to update the animation frame for walking
        function updateAnimation() {
            if (keys.up || keys.down || keys.left || keys.right) {
                player.currentFrame = (player.currentFrame + 1) % player.totalFrames;
            } else {
                player.currentFrame = 0; // Reset to first frame when stationary
            }
        }

        // Draw obstacles (walls)
        function drawObstacles() {
            ctx.fillStyle = "red";
            obstacles.forEach(obstacle => {
                ctx.fillRect(obstacle.x, obstacle.y, obstacle.width, obstacle.height);
            });
        }

        // Render the game
        function renderGame() {
            ctx.fillStyle = world.bgColor;
            ctx.fillRect(0, 0, world.width, world.height);

            drawObstacles();
            drawPlayer();
        }

        // Game loop
        function gameLoop() {
            updatePlayerPosition();
            updateAnimation();
            renderGame();
            requestAnimationFrame(gameLoop);
        }

        // Start game loop
        gameLoop();
    </script>
</body>
</html>
